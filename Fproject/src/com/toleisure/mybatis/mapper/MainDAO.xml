<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.toleisure.mybatis.dao.IMainDAO">


   <select id="AllGroupList"
      resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT NG_CODE AS ngCode, NG_PIC AS ngPic, GR_NAME AS grName, MEM_NAME AS memName, CATE1 AS
      grCate1Name, CATE2 AS grCate2Name, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount
      FROM ALL_GROUP_VIEW
      WHERE NG_STARTDATE>SYSDATE
      ORDER BY NG_DATE DESC
   </select>
   
    <select  id="CultureGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화') AND NG_STARTDATE > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화') AND NG_STARTDATE > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화') AND NG_STARTDATE > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="CultureCloseGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화')
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화')
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화')
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="CultureAbleGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시', '연극', '문화') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>

   <select  id="ExhibitGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시') AND NG_STARTDATE > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시') AND NG_STARTDATE > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시') AND NG_STARTDATE > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="ExhibitCloseGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시')
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시')
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시')
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="ExhibitAbleGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('전시') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>

	
	<select  id="ShowGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연') AND NG_STARTDATE > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연') AND NG_STARTDATE > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연') AND NG_STARTDATE > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="ShowCloseGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연')
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연')
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연')
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="ShowAbleGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('공연') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
   <select  id="PlayGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극') AND NG_STARTDATE > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극') AND NG_STARTDATE > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극') AND NG_STARTDATE > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="PlayCloseGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극')
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극')
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극')
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="PlayAbleGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('연극') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
   
   
   <!-- 필터 → 종료모임도 볼래요 -->
   
   <!-- 필터 → 참여가능한 모임만 볼래요 -->
   
   
   

   <!-- ============================================음식점 DAO================================================ -->
   <select  id="FoodGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페') AND NG_STARTDATE > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페') AND NG_STARTDATE > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페') AND NG_STARTDATE > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="FoodCloseGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페')
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페')
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페')
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="FoodAbleGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당','카페') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>



	<select  id="RestaurantGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당') AND NG_STARTDATE > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당') AND NG_STARTDATE > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당') AND NG_STARTDATE > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="RestaurantCloseGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당')
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당')
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당')
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="RestaurantAbleGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('식당') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>


	<select  id="CafeGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페') AND NG_STARTDATE > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페') AND NG_STARTDATE > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페') AND NG_STARTDATE > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="CafeCloseGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페')
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페')
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페')
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   
    <select  id="CafeAbleGroupList" parameterType="Integer" resultType="com.toleisure.mybatis.dto.GroupDTO">
            <choose>
               <when test='ordercheck==1'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY NG_DATE DESC
               </when>
               <when test='ordercheck==2'>
                  SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY FAVOR DESC
               </when>
               <otherwise>
                 SELECT NG_PIC AS ngPic,GR_NAME AS grName, CATE1 AS grCate1Name, CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name
			          , MEM_NAME AS memName, GR_COUNT AS grCount, STAR_AVG AS grStarAvg, STAR_COUNT AS grStarCount,NG_CODE AS ngCode
				  	FROM ALL_GROUP_VIEW
					WHERE CATE1 IN ('카페') AND NG_STARTDATE-2 > SYSDATE
					ORDER BY STAR_AVG DESC
               </otherwise>
            </choose>
   </select>
   <!-- ============================================음식점 DAO END================================================ -->

   <!-- ============================================테마별 DAO================================================ -->
  <select id="HotGroupList" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT grCode, ngCode, ngPic, grName, grCate1Name, CASE WHEN grCate2Name='0' THEN '' ELSE grCate2Name END AS grCate2Name
    	   , memName, grCount, grStarAvg, grStarCount, ngStartdate, grFavor
      FROM HOT_GROUP_VIEW
   </select>
   
  <select id="testList" parameterType="String" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT GR_CODE AS grCode,NG_CODE AS ngCode,NG_PIC AS ngPic, GR_NAME AS grName, MEM_NAME AS memName, CATE1 AS grCate1Name,
      CATE2 AS grCate2Name,JJIMCK AS jjimcheck
      FROM ALL_GROUP_VIEW_JJIM
      WHERE JJIMUSER = #{memId} or 1=1
   </select>

   <select id="HotGroupListAll" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT grCode, ngCode, ngPic, grName, grCate1Name, CASE WHEN grCate2Name='0' THEN '' ELSE grCate2Name END AS grCate2Name
     , memName, grCount, grStarAvg, grStarCount, ngStartdate, grFavor
      FROM HOT_GROUP_ALLVIEW
   </select>

   <select id="NewGroupList" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT grCode, ngCode, ngPic, grName, grCate1Name, CASE WHEN grCate2Name='0' THEN '' ELSE grCate2Name END AS grCate2Name
     , memName, grCount, grStarAvg, grStarCount, ngStartdate, grFavor
      FROM NEWEST_GROUP_VIEW 
   </select>

   <select id="NewGroupListAll"
      resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT grCode, ngCode, ngPic, grName, grCate1Name, CASE WHEN grCate2Name='0' THEN '' ELSE grCate2Name END AS grCate2Name
     , memName, grCount, grStarAvg, grStarCount, ngStartdate, grFavor
      FROM
      NEWEST_GROUP_ALLVIEW
   </select>

   <select id="HotHostList" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT MEM_PIC AS memPic, MEM_NAME AS memName, MEM_INTRO AS memIntro
      FROM HOT_HOST_VIEW
   </select>

   <select id="HotHostListAll" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT MEM_PIC AS memPic, MEM_NAME AS memName, MEM_INTRO AS memIntro
      FROM HOT_HOST_AllVIEW
   </select>

   <select id="ClosingGroupList" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT grCode, ngCode, ngPic, grName, grCate1Name, CASE WHEN grCate2Name='0' THEN '' ELSE grCate2Name END AS grCate2Name
     	   , memName, grCount, grStarAvg, grStarCount, ngStartdate, grFavor
      FROM CLOSING_GROUP_VIEW
   </select>

   <select id="ClosingGroupListAll" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT grCode, ngCode, ngPic, grName, grCate1Name, CASE WHEN grCate2Name='0' THEN '' ELSE grCate2Name END AS grCate2Name
    	   , memName, grCount, grStarAvg, grStarCount, ngStartdate, grFavor
      FROM CLOSING_GROUP_ALLVIEW
   </select>

   <select id="RecommendGroupList" resultType="com.toleisure.mybatis.dto.GroupDTO"
      parameterType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT E.ngPic AS ngPic,E.grName AS grName,E.memName AS
      memName,E.grCate1Name AS grCate1Name,E.grCate2Name AS grCate2Name, E.NG_CODE AS ngCode 
      FROM
      (
      SELECT NG.NG_PIC AS ngPic,G.GR_NAME AS grName,M.MEM_NAME AS
      memName,C1.CATE_NAME AS grCate1Name,C2.CATE_NAME AS grCate2Name, NG.NG_CODE
      FROM
      MEMBER M JOIN TBL_GROUP G
      ON M.CATE_CODE1=G.CATE_CODE1 OR M.CATE_CODE1=G.CATE_CODE2 OR
      M.CATE_CODE2=G.CATE_CODE1 OR M.CATE_CODE2=G.CATE_CODE2
      JOIN CATEGORY C1
      ON C1.CATE_CODE=G.CATE_CODE1
      JOIN CATEGORY C2
      ON C2.CATE_CODE=G.CATE_CODE2
      JOIN NOW_GROUP NG
      ON NG.GR_CODE = G.GR_CODE
      WHERE M.MEM_ID=#{memId}
      )E
      WHERE 3>=ROWNUM
   </select>

   <select id="RecommendGroupListAll"
      resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT E.ngPic AS ngPic,E.grName AS grName,E.memName AS
      memName,E.grCate1Name AS grCate1Name,E.grCate2Name AS grCate2Name, E.NG_CODE AS ngCode 
      FROM
      (
      SELECT NG.NG_PIC AS ngPic,G.GR_NAME AS grName,M.MEM_NAME AS
      memName,C1.CATE_NAME AS grCate1Name,C2.CATE_NAME AS grCate2Name, NG.NG_CODE
      FROM
      MEMBER M JOIN TBL_GROUP G
      ON M.CATE_CODE1=G.CATE_CODE1 OR M.CATE_CODE1=G.CATE_CODE2 OR
      M.CATE_CODE2=G.CATE_CODE1 OR M.CATE_CODE2=G.CATE_CODE2
      JOIN CATEGORY C1
      ON C1.CATE_CODE=G.CATE_CODE1
      JOIN CATEGORY C2
      ON C2.CATE_CODE=G.CATE_CODE2
      JOIN NOW_GROUP NG
      ON NG.GR_CODE = G.GR_CODE
      WHERE M.MEM_ID=#{memId}
      )E
      WHERE 10>=ROWNUM
   </select>

   <!-- ============================================테마별 DAO END================================================ -->

   <select id="AvgStar"
      resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT AVG(R.REVIEW_STAR) AS REVIEW_STAR_AVG
      FROM NOW_GROUP NG JOIN TBL_GROUP G
      ON NG.GR_CODE = G.GR_CODE
      JOIN FIXED_GROUP FG
      ON NG.NG_CODE=FG.NG_CODE
      JOIN GR_JOIN GJ
      ON FG.FIX_CODE=GJ.FIX_CODE
      JOIN REVIEW R
      ON R.JOIN_CODE=GJ.JOIN_CODE
      WHERE G.GR_CODE = #{starCode}
   </select>
   
   <!-- 모임 상세 페이지 내용 -->
   
   <select id="groupContent" parameterType="com.toleisure.mybatis.dto.GroupDTO" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT GRCODE AS grCode, NGCODE AS ngCode, NGPIC AS ngPic, NGFAVORITE AS ngFavorite, GRCATE1 AS grCate1, GRCATE2 AS grCate2, CATENAME1 AS grCate1Name, CATENAME2 AS grCate2Name
        , GRNAME AS grName, MEMPIC AS memPic, MEMNAME AS memName, NGMAX AS ngMax, NGMIN AS ngMin, NGCOST AS ngCost, NGMYINTRO AS ngMyIntro
        , TO_CHAR(NGSTART, 'YYYY-MM-DD HH24:MI') AS ngStart, TO_CHAR(NGEND, 'YYYY-MM-DD HH24:MI') AS ngEnd
        , NGLOCATION AS ngLocation, NGINTRO AS ngIntro, NGDATE AS ngDate, GRPRE AS grPre, GRNOTICE AS grNotice
        , MEMINTRO AS memIntro, GRCOUNT AS grCount, GRSTARAVG AS grStarAvg, GRSTARCOUNT AS grStarCount
      FROM GROUP_DETAIL_VIEW
      WHERE NGCODE = #{ngCode}
   </select>
   
   <!-- 모임 상세 페이지 찜 개수 -->
   <select id="jjimCount" parameterType="com.toleisure.mybatis.dto.GroupDTO" resultType="Integer">
   	SELECT COUNT(*) AS jjimCount
	FROM GR_FAVORITE
	WHERE NG_CODE=#{ngCode}
   </select>
   
   <!-- 모임 상세 페이지 후기 -->
   
   <select id="ContentReview" parameterType="com.toleisure.mybatis.dto.GroupDTO" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT GR_NAME AS grName, MEM_PIC AS memPic, MEM_NAME AS memName, REVIEW_CONT AS reviewCont, REVIEW_STAR AS reviewStar, TO_CHAR(REVIEW_DATE, 'YYYY-MM-DD HH24:MI') AS reviewDate
      FROM
      (
          SELECT GR.GR_NAME, NG.NG_CODE, ME.MEM_PIC, ME.MEM_NAME, RE.REVIEW_CONT, RE.REVIEW_STAR, RE.REVIEW_DATE
          FROM NOW_GROUP NG JOIN TBL_GROUP GR
          ON NG.GR_CODE = GR.GR_CODE
              JOIN GR_REQUEST QU
              ON QU.NG_CODE = NG.NG_CODE
                  JOIN PAYMENT PA
                  ON PA.RE_CODE = QU.RE_CODE
                      JOIN GR_JOIN JO
                      ON JO.PAY_CODE = PA.PAY_CODE
                          JOIN REVIEW RE
                          ON RE.JOIN_CODE = JO.JOIN_CODE
                              JOIN MEMBER ME
                              ON ME.MEM_ID = QU.MEM_ID
      )
      WHERE NG_CODE = #{ngCode}
   </select>
   
   <!-- 모임 상세 페이지 방명록 -->
   
   <select id="ContentGBoard" parameterType="com.toleisure.mybatis.dto.GroupDTO" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT BOARD_NUM AS boardNum, NG_CODE AS ngCode, MEM_PIC AS memPic, MEM_NAME AS memName, BOARD_CONT AS boardCont, BOARD_DATE AS boardDate
      FROM
      (
          SELECT GB.BOARD_NUM, GB.NG_CODE, MB.MEM_PIC, MB.MEM_NAME, GB.BOARD_CONT, GB.BOARD_DATE
          FROM GUESTBOARD GB JOIN NOW_GROUP NG
          ON GB.NG_CODE = NG.NG_CODE
              JOIN MEMBER MB
              ON MB.MEM_ID = GB.MEM_ID
      )   
      WHERE NG_CODE = #{ngCode}
   </select>
   
   <!-- 모임 상세 페이지 참여 인원 목록 -->
   
   <select id="ContentMember" parameterType="com.toleisure.mybatis.dto.GroupDTO" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT MEM_PIC AS memPic, MEM_NAME AS memName
      FROM PAYMENT PA, GR_REQUEST RE, NOW_GROUP NG, MEMBER MB
      WHERE RE.NG_CODE = NG.NG_CODE
        AND PA.RE_CODE = RE.RE_CODE
        AND RE.MEM_ID = MB.MEM_ID
        AND NG.NG_CODE = #{ngCode}   
   </select>
   
   
   <select id="meetFavCheck" parameterType="com.toleisure.mybatis.dto.GroupDTO" resultType="String">
      SELECT CASE WHEN COUNT(*)>=1 THEN 'Y' ELSE 'N' END
      FROM GR_FAVORITE
      WHERE MEM_ID=#{memId} AND NG_CODE=#{ngCode}
   </select>
   
   <select id="meetFavList" parameterType="String" resultType="com.toleisure.mybatis.dto.GroupDTO">
      SELECT NG_CODE AS ngCode
      FROM GR_FAVORITE
      WHERE MEM_ID=#{memId}
   </select>
   
   <insert id="meetFavInsert" parameterType="com.toleisure.mybatis.dto.GroupDTO" >
      INSERT INTO GR_FAVORITE(GF_CODE, MEM_ID, NG_CODE) VALUES(GR_FAVSEQ.NEXTVAL, #{memId}, #{ngCode})
   </insert>
   
   <select id="search"  parameterType="String" resultType="com.toleisure.mybatis.dto.GroupDTO">
	SELECT GR_CODE AS grCode,NG_PIC AS ngPic,CATE1 as grCate1Name,CASE WHEN CATE2='0' THEN '' ELSE CATE2 END AS grCate2Name,GR_NAME as grName,MEM_NAME as hostName
			,GR_COUNT as grCount,STAR_AVG AS grStarAvg,STAR_COUNT as grStarCount,MEM_ID as hostId,NG_CODE as ngCode,NG_STARTDATE as ngStart,FAVOR as ngFavorite
	FROM  ALL_GROUP_VIEW
	WHERE CATE1 LIKE '%' || #{search} || '%' OR CATE2 LIKE '%' || #{search} || '%' OR GR_NAME LIKE '%' || #{search} || '%' OR MEM_NAME LIKE '%' || #{search} || '%'
	ORDER BY NG_DATE
   </select>
   
   
</mapper>